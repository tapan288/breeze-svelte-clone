<script setup>
    import { onMount } from "svelte";

    export let show = false,
        maxWidth = "2xl",
        closeable = true,
        onClose = () => {};

    // const emit = defineEmits(['close']);

    // watch(
    //     () => props.show,
    //     () => {
    //         if (props.show) {
    //             document.body.style.overflow = 'hidden';
    //         } else {
    //             document.body.style.overflow = null;
    //         }
    //     }
    // );

    const close = () => {
        if (closeable) {
            onClose();
        }
    };

    const closeOnEscape = (e) => {
        if (e.key === "Escape" && show) {
            close();
        }
    };

    onMount(() => {
        document.addEventListener("keydown", closeOnEscape);

        return () => {
            document.removeEventListener("keydown", closeOnEscape);
            document.body.style.overflow = null;
        };
    });

    const maxWidthClass = {
        sm: "sm:max-w-sm",
        md: "sm:max-w-md",
        lg: "sm:max-w-lg",
        xl: "sm:max-w-xl",
        "2xl": "sm:max-w-2xl",
    }[maxWidth];
</script>

{#if show}
    <div
        class="fixed inset-0 overflow-y-auto px-4 py-6 sm:px-0 z-50"
        scroll-region
    >
        {#if show}
            <div
                on:click={close}
                class="fixed inset-0 transform transition-all"
            >
                <div class="absolute inset-0 bg-gray-500 opacity-75" />
            </div>
        {/if}

        {#if show}
            <div
                class="mb-6 bg-white rounded-lg overflow-hidden shadow-xl transform transition-all sm:w-full sm:mx-auto {maxWidthClass}"
            >
                {#if show}
                    <slot />
                {/if}
            </div>
        {/if}
    </div>
{/if}
